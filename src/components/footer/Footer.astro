---
// import { ThemeSwitch } from './ThemeSwitch'
// import {  footer } from '@/config.json'
import { getAllPostsWordCount } from '@/utils/content'
// import { RunningDays } from './RunningDays'
// import Link from './Link.astro'

// const sinceYear = new Date(footer.startTime).getFullYear()
// const thisYear = new Date().getFullYear()
// const copyDate = sinceYear === thisYear ? thisYear : `${sinceYear} - ${thisYear}`

const wordCount = await getAllPostsWordCount()

const wordCountStr = (wordCount / 1000).toFixed(1) + 'k'
---

<footer class="footer">
	<div class="waves">
		<div class="wave" id="wave1"></div>
		<div class="wave" id="wave2"></div>
		<div class="wave" id="wave3"></div>
		<div class="wave" id="wave4"></div>
	</div>

	<ul class="menu">
		<li class="menu__item">
			<a class="menu__link" href="#">å…±ç äº† {wordCountStr} é‚£ä¹ˆå¤šå­—</a>
		</li>
		<li class="menu__item"><a class="menu__link" href="/about">About us</a></li>
		<li class="menu__item">
			<a class="menu__link" href="https://astro.build/">ä½¿ç”¨äº†Astroåšå®¢æ¡†æ¶</a>
		</li>
		<li class="menu__item">
			<a href="https://travel.moe/go.html" target="_blank">
				<img
					src="https://travel.moe/images/logo/default-white.png"
					style="width:auto;height:24px"
					title="å¼‚æ¬¡å…ƒä¹‹æ—…-è·ƒè¿-æˆ‘ä»¬ä¸€èµ·å»èŒç«™æˆå‘˜çš„æ˜Ÿçƒæ—…è¡Œå§ï¼"
				/>
			</a>
		</li>
	</ul>
	<p><div class="quote">åŠ è½½ä¸­...</div></p>
	<p style="opacity: 0.75;">Made with ğŸ¤ by chenlin</p>
</footer>

<script>
	document.addEventListener('DOMContentLoaded', () => {
		const quoteElement = document.querySelector('.quote')

		// æ£€æŸ¥ quoteElement æ˜¯å¦ä¸º null
		if (!quoteElement) {
			console.error('å¼•ç”¨å…ƒç´ æœªæ‰¾åˆ°')
			return // å¦‚æœå¼•ç”¨å…ƒç´ æœªæ‰¾åˆ°ï¼Œç›´æ¥é€€å‡ºè„šæœ¬
		}

		// å°è¯•å¤šä¸ªAPIï¼Œç›´åˆ°æˆåŠŸ
		const apis = [
			'https://international.v1.hitokoto.cn/',
			'https://api.gushi.ci/all.json',
			'https://api.quotable.io/random',
		]

		const fetchWithFallback = async (urls: string[]) => {
			for (const url of urls) {
				try {
					const response = await fetch(url)
					if (!response.ok) continue

					const data = await response.json()
					// æ ¹æ®ä¸åŒAPIæ ¼å¼å¤„ç†æ•°æ®
					if (url.includes('hitokoto')) {
						quoteElement.textContent = data.hitokoto || data
					} else if (url.includes('gushi.ci')) {
						quoteElement.textContent = `${data.content} â€”â€”${data.author}`
					} else if (url.includes('quotable')) {
						quoteElement.textContent = `"${data.content}" â€”${data.author}`
					}
					return // æˆåŠŸåˆ™é€€å‡º
				} catch (e) {
					console.error(`API ${url} å¤±è´¥:`, e)
				}
			}
			quoteElement.textContent = 'è·å–å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•'
		}

		fetchWithFallback(apis)
	})
</script>
